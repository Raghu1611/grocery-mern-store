# Environment Variables Configuration

## Gmail API Configuration (Required for Email Sending)

### Step 1: Google Cloud Console Setup

1. Go to [Google Cloud Console](https://console.cloud.google.com/)
2. Create a new project or select an existing one
3. Enable Gmail API:
   - Go to "APIs & Services" > "Library"
   - Search for "Gmail API"
   - Click "Enable"

4. Create OAuth 2.0 Credentials:
   - Go to "APIs & Services" > "Credentials"
   - Click "Create Credentials" > "OAuth client ID"
   - Choose "Desktop app" as application type
   - Name it (e.g., "Grocery App Email Service")
   - Click "Create"
   - Copy the **Client ID** and **Client Secret**

### Step 2: Generate Refresh Token

Run the setup script:
```bash
node src/utils/gmailSetup.js
```

Follow the prompts:
1. The script will open a browser for OAuth authorization
2. Sign in with your Gmail account
3. Grant permissions
4. Copy the authorization code
5. Paste it back into the terminal
6. The script will generate your refresh token

### Step 3: Update .env File

Add these variables to your `.env` file:

```env
# Gmail API Configuration
GMAIL_CLIENT_ID=your_client_id_here
GMAIL_CLIENT_SECRET=your_client_secret_here
GMAIL_REDIRECT_URI=http://localhost:3000/oauth2callback
GMAIL_REFRESH_TOKEN=your_refresh_token_here
GMAIL_USER=your-email@gmail.com

# MongoDB
MONGODB_URI=your_mongodb_connection_string

# JWT
JWT_SECRET=your_jwt_secret_key

# Server
PORT=5000
```

### Testing Gmail API

To test your Gmail API configuration:
```bash
node src/utils/gmailSetup.js --test
```

This will verify:
- ✅ Credentials are valid
- ✅ Gmail API is accessible
- ✅ Email sending permissions are granted

## Benefits of Gmail API

✅ **No Port Issues** - Works through HTTPS (port 443)  
✅ **No Firewall Blocking** - Works on any network  
✅ **Higher Limits** - 2000 emails/day (vs 500 for SMTP)  
✅ **More Reliable** - Official Google API  
✅ **Faster** - Direct API calls  

## Troubleshooting

### "invalid_grant" Error
- Your refresh token expired
- Solution: Run `node src/utils/gmailSetup.js` again to generate a new token

### "Quota Exceeded" Error
- You've hit the daily sending limit (2000 emails)
- Solution: Wait 24 hours or request quota increase from Google

### "Gmail API not configured" Warning
- Missing environment variables
- Solution: Complete Steps 1-3 above

## Security Notes

⚠️ **Never commit your `.env` file to Git**  
⚠️ **Keep your Client Secret and Refresh Token private**  
⚠️ **Add `.env` to `.gitignore`**  
⚠️ **Rotate credentials if exposed**
